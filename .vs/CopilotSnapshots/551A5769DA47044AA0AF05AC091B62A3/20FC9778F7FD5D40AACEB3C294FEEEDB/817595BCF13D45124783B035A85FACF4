# ExpenseManager Project Architecture Diagram

## Overview
This is a WPF-based Expense Management application built on .NET Framework 4.7.2 with machine learning capabilities for expense classification.

## Architecture Diagram

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                   PRESENTATION LAYER                            │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐            │
│  │   MainWindow    │    │ AddExpenseWindow│    │  MonthlyWindow  │            │
│  │     (.xaml)     │    │     (.xaml)     │    │     (.xaml)     │            │
│  │                 │    │                 │    │                 │            │
│  │ - Dashboard     │    │ - Add Expense   │    │ - Monthly Stats │            │
│  │ - Charts        │    │ - Prediction    │    │ - Reports       │            │
│  │ - Data Grid     │    │ - Validation    │    │ - Analytics     │            │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘            │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
                                         │
                                         ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                  CONTROLLER LAYER                               │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐            │
│  │ExpenseController│    │MonthlyController│    │PredictionCtrl   │            │
│  │                 │    │                 │    │                 │            │
│  │ - AddExpense    │    │ - GetReports    │    │ - ClassifyText  │            │
│  │ - GetExpenses   │    │ - GetStats      │    │ - TrainModel    │            │
│  │ - DeleteExpense │    │ - GetTrends     │    │ - GetPrediction │            │
│  │ - LoadFromJSON  │    │                 │    │                 │            │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘            │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
                                         │
                                         ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                   SERVICE LAYER                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐            │
│  │ ExpenseManager  │    │MonthlyExpense   │    │ ExpensePredictor│            │
│  │    Service      │    │    Service      │    │                 │            │
│  │                 │    │                 │    │ ┌─────────────┐ │            │
│  │ - Business Logic│    │ - Monthly Calc  │    │ │MLClassifier │ │            │
│  │ - Validation    │    │ - Report Gen    │    │ │             │ │            │
│  │ - Data Transform│    │ - Trend Analysis│    │ │ - Training  │ │            │
│  │ - File I/O      │    │                 │    │ │ - Prediction│ │            │
│  └─────────────────┘    └─────────────────┘    │ │ - SaveModel │ │            │
│                                                 │ └─────────────┘ │            │
│                                                 │ ┌─────────────┐ │            │
│                                                 │ │RuleBasedClsf│ │            │
│                                                 │ │             │ │            │
│                                                 │ │ - Keywords  │ │            │
│                                                 │ │ - Rules     │ │            │
│                                                 │ └─────────────┘ │            │
│                                                 └─────────────────┘            │
└─────────────────────────────────────────────────────────────────────────────────┘
                                         │
                                         ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                 REPOSITORY LAYER                                │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐            │
│  │ExpenseRepository│    │MonthlyRepository│    │PredictionRepo   │            │
│  │                 │    │                 │    │                 │            │
│  │ - CRUD Ops      │    │ - Monthly Data  │    │ - Training Data │            │
│  │ - JSON Storage  │    │ - Aggregations  │    │ - Model Storage │            │
│  │ - Data Access   │    │ - Time Queries  │    │ - CSV Loading   │            │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘            │
│          │                       │                       │                     │
│          │                       │                       │                     │
│  ┌───────▼───────┐    ┌─────────▼─────────┐    ┌─────────▼─────────┐          │
│  │IExpenseRepo   │    │IMonthlyRepo      │    │IPredictionRepo   │          │
│  │ (Interface)   │    │ (Interface)      │    │ (Interface)      │          │
│  └───────────────┘    └───────────────────┘    └───────────────────┘          │
└─────────────────────────────────────────────────────────────────────────────────┘
                                         │
                                         ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                   MODEL LAYER                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐           │
│  │   Expense   │  │ ExpenseData │  │ ModelData   │  │MonthlyReport│           │
│  │             │  │             │  │             │  │             │           │
│  │ - Amount    │  │ - Label     │  │ - Weights   │  │ - Month     │           │
│  │ - Desc      │  │ - Text      │  │ - Bias      │  │ - Total     │           │
│  │ - Date      │  │             │  │ - Vocab     │  │ - Categories│           │
│  │ - Category  │  │             │  │             │  │ - Trends    │           │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘           │
│                                                                                 │
│  ┌─────────────┐  ┌─────────────┐                                              │
│  │CategoryData │  │PredictionRes│                                              │
│  │             │  │             │                                              │
│  │ - Name      │  │ - Category  │                                              │
│  │ - Count     │  │ - Confidence│                                              │
│  │ - Total     │  │ - Method    │                                              │
│  └─────────────┘  └─────────────┘                                              │
└─────────────────────────────────────────────────────────────────────────────────┘
                                         │
                                         ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                   UTILITY LAYER                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐            │
│  │   Vietnamese    │    │ CategoryHelper  │    │      DBG        │            │
│  │                 │    │                 │    │                 │            │
│  │ - RemoveDiacrit │    │ - CategoryMaps  │    │ - Debug Output  │            │
│  │ - Text Process  │    │ - Validation    │    │ - Logging       │            │
│  │                 │    │ - Normalization │    │                 │            │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘            │
└─────────────────────────────────────────────────────────────────────────────────┘
                                         │
                                         ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                   DATA STORAGE                                  │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐            │
│  │   JSON Files    │    │   CSV Training  │    │   ML Models     │            │
│  │                 │    │     Data        │    │                 │            │
│  │ expenses.json   │    │ anuong.csv     │    │trained_model.json│           │
│  │ categories.json │    │ muasam.csv     │    │                 │            │
│  │                 │    │ giaitri.csv    │    │                 │            │
│  │                 │    │ khac.csv       │    │                 │            │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘            │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## Key Features & Components

### 🎯 Core Functionality
- **Expense Management**: Add, view, delete, categorize expenses
- **Real-time Dashboard**: Charts, statistics, category breakdown
- **Monthly Reports**: Trends, analytics, period comparisons
- **Data Persistence**: JSON-based storage system

### 🤖 Machine Learning Features
- **Automatic Classification**: ML-based expense categorization
- **Training System**: CSV-based training data management
- **Dual Classifiers**: 
  - MLClassifier (Neural Network-like approach)
  - RuleBasedClassifier (Keywords/Rules)
- **Vietnamese Text Processing**: Diacritic removal, text normalization
- **Model Persistence**: Save/load trained models

### 📊 Categories
1. **Ăn uống** (Food & Drinks) - 🍽️
2. **Mua sắm** (Shopping) - 🛍️
3. **Giải trí** (Entertainment) - 🎮
4. **Khác** (Others) - 📦

### 🏗️ Architecture Patterns
- **Layered Architecture**: Clear separation of concerns
- **Repository Pattern**: Data access abstraction
- **Interface Segregation**: IExpenseClassifier, IRepository interfaces
- **Dependency Injection**: Constructor injection for repositories
- **MVVM-like**: WPF with code-behind and controllers

### 📁 Project Structure
```
ExpenseManager/
├── Controllers/           # Business logic coordination
├── Models/               # Data models and entities
├── Services/             # Business services and ML
├── Repository/           # Data access layer
├── Views/                # WPF UI components
├── Utils/                # Helper utilities
└── Data/                 # Training data and storage
    ├── TrainingData/     # CSV files for ML training
    ├── User/             # User data storage
    └── Models/           # Saved ML models
```

### 🔧 Technology Stack
- **.NET Framework 4.7.2**
- **WPF** (Windows Presentation Foundation)
- **C# 7.3**
- **System.Text.Json** for data serialization
- **Custom ML Implementation** (no external ML libraries)
- **CSV/JSON** for data storage

### 🚀 Data Flow
1. **User Input** → Views → Controllers
2. **Business Logic** → Services → Repository
3. **ML Prediction** → ExpensePredictor → Classifiers
4. **Data Storage** → JSON files and CSV training data
5. **Real-time Updates** → Repository → Services → Controllers → Views

This architecture provides a robust, maintainable expense management system with advanced ML-powered categorization capabilities.